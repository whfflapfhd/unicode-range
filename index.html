<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Convert Unicode</title>    
    <link rel="stylesheet" href="assets/css/nexon.min.css">
    <link rel="stylesheet" href="assets/css/common.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <h1 class="page-title">Convert Unicode</h1>
    <div class="container">
        <div class="convert-type">
            <span class="type-btn"><input type="radio" id="typeA" name="inputType" value="0" checked /><label for="typeA">Unicode to Text</label></span>
            <span class="type-btn"><input type="radio" id="typeB" name="inputType" value="1" /><label for="typeB">Text to Unicode</label></span>
        </div>
        <div class="search-wrap search-unicode">
            <input type="text" class="codeList" />
            <button type="button" class="btn-search btnConvert">변환</button>
        </div>
        <p class="example">
            <span class="on">ex) U+AC00 || U+AC00-AC05 || U+AC00, U+AC05-AC0F</span>
            <span>ex) ㄱ || 가 || 가나다라마AbcdEF</span>
        </p>
        <div class="output-area"></div>
    </div>
</body>
<script type="text/javascript">
//<![CDATA[
    var convert = {
        checkError : function(){
            if(this.value == ""){
                alert('입력값이 없습니다');
                this.reset();                
            }else if(this.type=="0" && !this.value.match(/U+/g)){
                alert('유효하지 않은 값입니다');
                this.reset();                
            }else{
                (!this.type) ? this.makeText() : this.makeUnicode();
            }
        },
        makeText : function(){
            var _this = this;            
            var arrayUnicode = _this.value.replace(/[U+.]/g,'').replace(/\s/g,'').toUpperCase().split(',');
            arrayUnicode.forEach(function(ele){                
                if(ele.indexOf("-") > 0){
                    _this.getRange(ele)
                }else{
                    ele = Number("0x"+ele);
                    var str = String.fromCharCode(ele);                    
                    _this.result.push(str);
                }
            });
            this.result = this.result.join("");
            this.print();
        },
        makeUnicode : function(){
            var _this = this;
            var  arrayStr =_this.value.split("");
            arrayStr.forEach(function(ele){
                var str = ele.charCodeAt(0).toString(16).toUpperCase();
                while (str.length < 4) {
                  str = '0' + str;
                }
                _this.result.push("U+"+str);
            });
            this.result = this.result.join(", ");
            this.print()
        },
        getRange : function(r){
            var r= r.split("-");
            var at = Number("0x"+r[0]);
            var until = Number("0x"+r[1]);
            for(var i = at;i < until+1; i++){
                var str = String.fromCharCode(i);
                this.result.push(str);
            }
        },
        print : function(){
            $(".output-area").html(this.result).addClass("on").selectText();
            //document.execCommand("copy");
        },
        reset : function(){
            $(".output-area").removeClass("on");
            $(".codeList").val("").focus();
            $(".example").find("span").removeClass("on").eq(Number($(".convert-type input:checked").val())).addClass("on")
        }
    };
    $(document.body).on("click",".btnConvert",function(){
        convert.result = [];
        convert.type = Number($(".convert-type input:checked").val());
        convert.value = $(".codeList").val();     
        convert.checkError();
    }).on("change",".convert-type input",convert.reset);
    jQuery.fn.selectText = function(){
        var doc = document;
        var element = this[0];
        if (doc.body.createTextRange) {
            var range = document.body.createTextRange();
            range.moveToElementText(element);
            range.select();
        } else if (window.getSelection) {
            var selection = window.getSelection();
            var range = document.createRange();
            range.selectNodeContents(element);
            selection.removeAllRanges();
            selection.addRange(range);
        }
    };
//]]>
</script>
</html>